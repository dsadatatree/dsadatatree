<!DOCTYPE HTML>


<html>
	<head>
		<title>Data Tree</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<a href="index.html" class="logo"><strong>DSA</strong> <span>programa de mentoria</span></a>
						<nav>
							<a href="#menu">Menu</a>
						</nav>
					</header>

				<!-- Menu -->
				<nav id="menu">
					<ul class="links">
						<li><a href="index.html">Home</a></li>
						<li><a href="landing.html">Quem Somos</a></li>
						<li><a href="mentoring.html">Programa de Mentoria</a></li>
						<li><a href="Database.html">Banco de Dados</a></li>
						<li><a href="exploratory_analysis.html">Análise Exploratória</a></li>
					</ul>
					<ul class="actions stacked">
						<li><a href="summary.html" class="button primary fit">Sumário Executivo</a></li>
					</ul>
				</nav>

				<!-- Main -->
					<div id="main" class="alt">

						<!-- One -->
							<section id="one">
								<div class="inner">
									<header class="major">
										<h1>&nbsp;&nbsp;<img src="images/logo.png" width= 4% alt="" />&nbsp;Pré processamento dos Dados</h1>
									</header>
									<span ><img src="images/preproc.png" width= 80% alt="" /></span>
								<p></p>
									<p>Nesta parte do projeto será realizado a modelagem de dados, como: Data Cleaning e Data Wrangling 
										e enriquecimento da dados, utilizando linguagem Python para futura análise exploratória.</p>


									<h2>1. Carregando a Base de Dados</h2>

									<details><summary>1.1 Para coletar o dados basta entrar no link: <a target="_blank" href="https://sineaberto.economia.gov.br/publico/D_ETL_IMO_EXTRACAO_SINE_ABERTO_TRABALHADORES_SC.zip">SINE</a>, 
										e realizar o download do arquivo:</summary>
									</br>
									

										<pre><code>df = pd.read_csv("Dados/D_ETL_IMO_EXTRACAO_SINE_ABERTO_TRABALHADORES_SC.csv",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sep = ";", encoding='latin-1')<br>df_CBO = pd.read_csv('Dados/cbo.csv',sep=';', encoding = "ISO-8859–1")
										</code></pre>

										<p>Ao colocar o comando abaixo, observa-se a quantidade de observações e variáveis.</p>
										<pre><code>df.shape</code></pre>
										<p># (458965, 20)</p>

										<p> O conjunto de dados possuem 458.965 observações (linhas) e 20 variáveis (colunas)</p>

										<p>Abaixo segue amostra do conjunto:</p>
										<pre><code>df.head(2)</code></pre>
									</details>
									</br>
										<table border="1" class="dataframe">
											<thead>
											  <tr style="text-align: right;">
												<th></th>
												<th>NACIONALIDADE</th>
												<th>DEFICIENCIAS</th>
												<th>BAIRRO</th>
												<th>CEP</th>
												<th>CODIGO_MUNICIPIO_IBGE</th>
												<th>NOME_MUNICIPIO</th>
												<th>UF</th>
												<th>ESCOLARIDADE</th>
												<th>ESTUDANTE</th>
												<th>CURSOS_PROFISSIONALIZANTES</th>
												<th>GRADUACOES</th>
												<th>POS_GRADUACOES</th>
												<th>IDIOMAS</th>
												<th>HABILITACAO</th>
												<th>VEICULOS</th>
												<th>DISP_VIAJAR</th>
												<th>DISP_DORMIR_EMP</th>
												<th>DISP_AUSENTAR_DOMIC</th>
												<th>PRETENSOES</th>
												<th>MUNICIPIOS_INTERESSE</th>
											  </tr>
											</thead>
											<tbody>
											  <tr>
												<th>0</th>
												<td>ESTRANGEIRA</td>
												<td>NaN</td>
												<td>BARRAGEM</td>
												<td>89165108.0</td>
												<td>421480</td>
												<td>RIO DO SUL</td>
												<td>SC</td>
												<td>Médio Completo</td>
												<td>N</td>
												<td>TÉCNICO EM ELÉTRICA/REFRIGERAÇÃO</td>
												<td>NaN</td>
												<td>NaN</td>
												<td>NaN</td>
												<td>Nenhum</td>
												<td>N</td>
												<td>S</td>
												<td>S</td>
												<td>S</td>
												<td>414105-Almoxarife(N,15,0,Indiferente)|(...)</td>
												<td>NaN</td>
											  </tr>
											  <tr>
												<th>1</th>
												<td>BRASILEIRA</td>
												<td>NaN</td>
												<td>CAMINHO NOVO</td>
												<td>88132373.0</td>
												<td>421190</td>
												<td>PALHOCA</td>
												<td>SC</td>
												<td>Médio Completo</td>
												<td>S</td>
												<td>NaN</td>
												<td>NaN</td>
												<td>NaN</td>
												<td>Inglês Básico</td>
												<td>A</td>
												<td>S</td>
												<td>S</td>
												<td>S</td>
												<td>S</td>
												<td>414105-Auxiliar de almoxarifado(N,149,0,Indiferente)| (...)</td>
												<td>NaN</td>
											  </tr>
											</tbody>
										  </table>	
										  
										  
										</br>
										<details><summary>1.2 Sample dos Dados</summary>
										</br>
										
										  <P> Amostra aleatória com proporção de 30% do conjunto de Dados.								  </P>
										  <pre><code>df_fatia = df.sample(frac=0.3, replace = False, random_state = 1)</code></pre>

										  <pre><code>df_fatia.shape</code></pre>
										<p># (137.690, 20)</p>
										<p>Para salvar este novo conjunto de dados, basta seguir a instrução abaixo.</p>
										<pre><code>df_fatia.to_csv('df_fatia.csv', index = False)</code></pre>
									</details>
								</br>
								<hr />
										<h2>2. Limpeza dos Dados</h2>

										<details><summary>2.1 Carregando Bibliotecas e Carregando os dados:</summary>
										<p> Para iniciar o trabalho é preciso carregar algumas bibliotecas:</P>
										<pre><code>import pandas as pd</br>import re</br>import unidecode</br>import matplotlib as plt</code></pre>
										<h4>Carregando o conjunto de dados</h4>
										<p>O conjunto de dados <b>pib_cidade.csv</b>, retirado do <a target="_blank" href="https://pt.wikipedia.org/wiki/Lista_de_munic%C3%ADpios_de_Santa_Catarina_por_PIB">Wikipedia</a>, consta no Github, repositório do projeto.</p>
										<pre><code>df_fatia = pd.read_csv('df_fatia.csv')</br>pib = pd.read_csv('pib_cidade.csv', sep = ';', encoding='latin1')</code></pre>
										</details>

									<hr />
									<br>
										<details><summary>2.2 Excluindo alguns registros</summary>

											<p>Na coluna <b>ESCOLARIDADE</b> foi removido, todos os registros  classificado como:
												<b>Não identificado </b>(6,43% do nosso conjunto de dados). Conforme podemos ver abaixo:</b></p>
												<table border="1" class="dataframe">
													<thead>
													  <tr style="text-align: right;">
														<th></th>
														<th>Perc. (%)</th>
													  </tr>
													</thead>
													<tbody>
													  <tr>
														<th>Médio Completo</th>
														<td>52.41</td>
													  </tr>
													  <tr>
														<th>Fundamental Completo</th>
														<td>11.13</td>
													  </tr>
													  <tr>
														<th>Médio Incompleto</th>
														<td>10.62</td>
													  </tr>
													  <tr>
														<th>Superior Completo</th>
														<td>7.92</td>
													  </tr>
													  <tr>
														<th>Não Identificado</th>
														<td>6.49</td>
													  </tr>
													  <tr>
														<th>Superior Incompleto</th>
														<td>6.43</td>
													  </tr>
													  <tr>
														<th>Fundamental Incompleto</th>
														<td>3.01</td>
													  </tr>
													  <tr>
														<th>Nenhum</th>
														<td>1.20</td>
													  </tr>
													  <tr>
														<th>Analfabeto</th>
														<td>0.36</td>
													  </tr>
													  <tr>
														<th>Especialização</th>
														<td>0.34</td>
													  </tr>
													  <tr>
														<th>Mestrado</th>
														<td>0.07</td>
													  </tr>
													  <tr>
														<th>Doutorado</th>
														<td>0.01</td>
													  </tr>
													</tbody>
												  </table>
												  <p>Na coluna <b>NACIONALIDADE</b> também removido todos os registro que foram classificados como 
													<b>IGNORADOS</b> (11,76% do nosso conjunto de dados). </p>
													<table border="1" class="dataframe">
														<thead>
														  <tr style="text-align: right;">
															<th></th>
															<th>Perc. (%)</th>
														  </tr>
														</thead>
														<tbody>
														  <tr>
															<th>BRASILEIRA</th>
															<td>86.11</td>
														  </tr>
														  <tr>
															<th>IGNORADO</th>
															<td>11.76</td>
														  </tr>
														  <tr>
															<th>ESTRANGEIRA</th>
															<td>1.98</td>
														  </tr>
														  <tr>
															<th>NATURALIZADO BRASILEIRO</th>
															<td>0.09</td>
														  </tr>
														  <tr>
															<th>BRASILEIRO NASCIDO NO EXTERIOR</th>
															<td>0.07</td>
														  </tr>
														</tbody>
													  </table>
													
										</details>



										<hr />
										<br>
										<details><summary>2.3 Criando Colunas Numéricas:</summary>

										<p> Na coluna <B>ESTUDANTE</B>, possue duas classificações: Estudante ("S") e Não Estudante ("N"). Será criada uma coluna 
											do tipo numérica, sendo 1 para estudante e 0 para não estudante.</p>
										<pre><code>df['Estudante'] = None</br>df['Estudante'] = df['ESTUDANTE'].apply(lambda x: 1 if x == 'S' else 0)</code></pre>
										<p>Segue a coluna abaixo:</p>
										<pre><code>df_fatia[['ESTUDANTE','Estudante']].tail(3)</code></pre>
										<table border="1" class="dataframe">
											<thead>
											  <tr style="text-align: right;">
												<th></th>
												<th>ESTUDANTE</th>
												<th>Estudante</th>
											  </tr>
											</thead>
											<tbody>
											  <tr>
												<th>137686</th>
												<td>N</td>
												<td>0</td>
											  </tr>
											  <tr>
												<th>137687</th>
												<td>S</td>
												<td>1</td>
											  </tr>
											  <tr>
												<th>137688</th>
												<td>N</td>
												<td>0</td>
											  </tr>
											</tbody>
										  </table>

										  Dados a quantidade de estudante não estudante do conjutno de dados:
										  <pre><code>df_fatia['Estudante'].value_counts()</code></pre>
										<p>#  0 &nbsp;&nbsp;&nbsp; 125131 </br># 1 &nbsp;&nbsp;&nbsp;12558</br>Name: Estudante, dtype: int 64</p>

										<pre><code>estudante = df_fatia['ESTUDANTE'].value_counts()</br>ax = estudante.plot(kind = 'barh', color = ['red','blue'], title = 'Quantidade de Cantidade Estudantes e \n Não Estudantes',</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xlabel = "Categoria")</code></pre>
										<img  src="images/estudante.01.png",   width= 70% alt="" />

										<p>O mesmo  ocorrido para a variável Estudante serão desenvolvido nas seguintes variáveis: <b>'VEICULOS', 'DISP_VIAJAR', 'DISP_DORMIR_EMP', 'DISP_AUSENTAR_DOMIC' e 'ESCOLARIDADE'.</b></p>
										<pre><code>df_fatia['Veiculo'] = None</br>df_fatia['Veiculo'] = df_fatia['VEICULOS'].apply(lambda x: 1 if x == 'S' else 0)</br></br>df_fatia['Viajar'] = None</br>df_fatia['Viajar'] = df_fatia['DISP_VIAJAR'].apply(lambda x: 1 if x == 'S' else 0)</br></br>df_fatia['Dormir_local'] = None</br>df_fatia['Dormir_local'] = df_fatia['DISP_DORMIR_EMP'].apply(lambda x: 1 if x == 'S' else 0)</br></br>df_fatia['Ausentar_Domic'] = None</br>df_fatia['Ausentar_Domic'] = df_fatia['DISP_AUSENTAR_DOMIC'].apply(lambda x: 1 if x == 'S' else 0)</code></pre>
										
										  <table border="1" class="dataframe">
											 <tr>
												<th>ESCOLARIDADE</th>
												<th>Nivel_esc</th>
												<th>Quantidade</th>
											  </tr>
											</thead>
											<tbody>
											  <tr>
												<th>Médio Completo</th>
												<th>2</th>
												<td>72167</td>
											  </tr>
											  <tr>
												<th>Fundamental Completo</th>
												<th>1</th>
												<td>15326</td>
											  </tr>
											  <tr>
												<th>Médio Incompleto</th>
												<th>2</th>
												<td>14627</td>
											  </tr>
											  <tr>
												<th>Superior Completo</th>
												<th>3</th>
												<td>10908</td>
											  </tr>
											  <tr>
												<th>Superior Incompleto</th>
												<th>3</th>
												<td>8852</td>
											  </tr>
											  <tr>
												<th>Fundamental Incompleto</th>
												<th>1</th>
												<td>4142</td>
											  </tr>
											  <tr>
												<th>Nenhum</th>
												<th>0</th>
												<td>1646</td>
											  </tr>
											  <tr>
												<th>Analfabeto</th>
												<th>0</th>
												<td>499</td>
											  </tr>
											  <tr>
												<th>Especialização</th>
												<th>3</th>
												<td>466</td>
											  </tr>
											  <tr>
												<th>Mestrado</th>
												<th>3</th>
												<td>101</td>
											  </tr>
											  <tr>
												<th>Doutorado</th>
												<th>3</th>
												<td>14</td>
											  </tr>
											</tbody>
										  </table>
										</details>
										 
										
										<hr />
										<br>



										<h2>3. Enriquecimento de Base</h2>

										<details><summary>3.1 Coluna Região:</summary>

											<p>Categorização das cidades em regiões municipais no Estado de Santa Catarina, Conforme o seguinte 
												<a target="_blank"href="https://www.causc.gov.br/wp-content/uploads/chamadas/2429/10.-ANEXO-VII-Divisao-do-Municipios-do-Estado-de-SC-por-Mesorregioes.pdf">link</a>.</p>
								Segue o dicionário de dados com a coluna região, criada:</p>
								<pre><code>reg = {'ararangua':'sul','armazem':'sul','balneario arroio do silva':'sul','balneario gaivota':'sul','balneario rincao':'sul','braco do norte':'sul','capivari de baixo':'sul','cocal do sul':'sul','criciuma':'sul','ermo':'sul','forquilhinha':'sul','garopaba':'sul','grao para':'sul','gravatal':'sul','icara':'sul','imarui':'sul','imbituba':'sul','jacinto machado':'sul','jaguaruna':'sul','laguna':'sul','lauro muller':'sul','maracaja':'sul','meleiro':'sul','morro da fumaca':'sul','morro grande':'sul','nova veneza':'sul','orleans':'sul','passo de torres':'sul','pedras grandes':'sul','pescaria brava':'sul','praia grande':'sul','rio fortuna':'sul','sangao':'sul','santa rosa de lima':'sul','santa rosa do sul':'sul','sao joao do sul':'sul','sao ludgero':'sul','sao martinho':'sul','sideropolis':'sul','sombrio':'sul','timbe do sul':'sul','treviso':'sul','treze de maio':'sul','tubarao':'sul','turvo':'sul','urussanga':'sul',</br>'aguas mornas':'grande florianópolis','alfredo wagner':'grande florianópolis','angelina':'grande florianópolis','anitapolis':'grande florianópolis','antonio carlos':'grande florianópolis','biguacu':'grande florianópolis','canelinha':'grande florianópolis','florianopolis':'grande florianópolis','governador celso ramos':'grande florianópolis','leoberto leal':'grande florianópolis','major gercino':'grande florianópolis','nova trento':'grande florianópolis','palhoca':'grande florianópolis','paulo lopes':'grande florianópolis','rancho queimado':'grande florianópolis','santo amaro da imperatriz':'grande florianópolis','sao bonifacio':'grande florianópolis','sao joao batista':'grande florianopolis','sao jose':'grande florianópolis','sao pedro de alcantara':'grande florianópolis','tijucas':'grande florianópolis',</br>'araquari':'norte','balneario barra do sul':'norte','bela vista do toldo':'norte','campo alegre':'norte','canoinhas':'norte','corupa':'norte','garuva':'norte','guaramirim':'norte','irineppolis':'norte','itaiopolis':'norte','itapoa':'norte','jaragua do sul':'norte','joinville':'norte','mafra':'norte','major vieira':'norte','massaranduba':'norte','monte castelo':'norte','papanduva':'norte','porto uniao':'norte','rio negrinho':'norte','santa terezinha':'norte','sao bento do sul':'norte','sao francisco do sul':'norte','schroeder':'norte','timbo grande':'norte','tres barras':'norte',</br>'abelardo luz': 'oeste','agua doce': 'oeste','aguas de chapeco': 'oeste','aguas frias': 'oeste','alto bela vista': 'oeste','anchieta': 'oeste','arabuta': 'oeste','arroio trinta': 'oeste','arvoredo': 'oeste','bandeirante': 'oeste','barra bonita': 'oeste','belmonte': 'oeste','bom jesus': 'oeste','bom jesus do oeste': 'oeste','cacador': 'oeste','caibi': 'oeste','calmon': 'oeste','campo ere': 'oeste','capinzal': 'oeste','catanduvas': 'oeste','caxambu do sul': 'oeste','chapeco': 'oeste','concordia': 'oeste','cordilheira alta': 'oeste','coronel freitas': 'oeste','coronel martins': 'oeste','cunha pora': 'oeste','cunhatai': 'oeste','descanso': 'oeste','dionisio cerqueira': 'oeste','entre rios': 'oeste','erval velho': 'oeste','faxinal dos guedes': 'oeste','flor do sertao': 'oeste','formosa do sul': 'oeste','fraiburgo': 'oeste','galvao': 'oeste','guaraciaba': 'oeste','guaruja do sul': 'oeste','guatambu': 'oeste',"herval d oeste": 'oeste','ibiam': 'oeste','ibicare': 'oeste','iomere': 'oeste','ipira': 'oeste','ipora do oeste': 'oeste','ipuacu': 'oeste','ipumirim': 'oeste','iraceminha': 'oeste','irani': 'oeste','irati': 'oeste','ita': 'oeste','itapiranga': 'oeste','jabora': 'oeste','jardinopolis': 'oeste','joacaba': 'oeste','jupia': 'oeste','lacerdopolis': 'oeste','lajeado grande': 'oeste','lebon regis': 'oeste','lindoia do sul': 'oeste','luzerna': 'oeste','macieira': 'oeste','maravilha': 'oeste','marema': 'oeste','matos costa': 'oeste','modelo': 'oeste','mondai': 'oeste','nova erechim': 'oeste','nova itaberaba': 'oeste','novo horizonte': 'oeste','ouro': 'oeste','ouro verde': 'oeste','paial': 'oeste','palma sola': 'oeste','palmitos': 'oeste','paraiso': 'oeste','passos maia': 'oeste','peritiba': 'oeste','pinhalzinho': 'oeste','pinheiro preto': 'oeste','piratuba': 'oeste','planalto alegre': 'oeste','ponte serrada': 'oeste','presidente castelo branco': 'oeste','princesa': 'oeste','quilombo': 'oeste','rio das antas': 'oeste','riqueza': 'oeste','romelandia': 'oeste','saltinho': 'oeste','salto veloso': 'oeste','santa helena': 'oeste','santa terezinha do progresso': 'oeste','santiago do sul': 'oeste','sao bernardino': 'oeste','sao carlos': 'oeste','sao domingos': 'oeste','sao joao do oeste': 'oeste','sao jose do cedro': 'oeste','sao lourenco do oeste': 'oeste','sao miguel da boa vista': 'oeste','sao miguel do oeste': 'oeste','saudades': 'oeste','seara': 'oeste','serra alta': 'oeste','sul brasil': 'oeste','tangara': 'oeste','tigrinhos': 'oeste','treze tilias': 'oeste','tunapolis': 'oeste','uniao do oeste': 'oeste','vargeao': 'oeste','vargem bonita': 'oeste','videira': 'oeste','xanxere': 'oeste','xavantina': 'oeste','xaxim': 'oeste',</br>'abdon batista' : 'serrtana','anita garibaldi' : 'serrtana','bocaina do sul' : 'serrtana','bom jardim da serra' : 'serrtana','bom retiro' : 'serrtana','brunopolis' : 'serrtana','campo belo do sul' : 'serrtana','campos novos' : 'serrtana','capao alto' : 'serrtana','celso ramos' : 'serrtana','cerro negro' : 'serrtana','correia pinto' : 'serrtana','curitibanos' : 'serrtana','frei rogerio' : 'serrtana','lages' : 'serrtana','monte carlo' : 'serrtana','otacilio costa' : 'serrtana','painel' : 'serrtana','palmeira' : 'serrtana','ponte alta' : 'serrtana','ponte alta do norte' : 'serrtana','rio rufino' : 'serrtana','santa cecilia' : 'serrtana','sao cristovao do sul' : 'serrtana','sao joaquim' : 'serrtana','sao jose do cerrito' : 'serrtana','urubici' : 'serrtana','urupema' : 'serrtana','vargem' : 'serrtana','zortea' : 'serrtana',</br>'agrolandia' : 'vale do iajaí','agronomica' : 'vale do iajaí','apiuna' : 'vale do iajaí','ascurra' : 'vale do iajaí','atalanta' : 'vale do iajaí','aurora' : 'vale do iajaí','balneario camboriu' : 'vale do iajaí','balneario picarras' : 'vale do iajaí','barra velha' : 'vale do iajaí','benedito novo' : 'vale do iajaí','blumenau' : 'vale do iajaí','bombinhas' : 'vale do iajaí','botuvera' : 'vale do iajaí','braco do trombudo' : 'vale do iajaí','brusque' : 'vale do iajaí','camboriu': 'vale do iajaí','chapadao do lageado' : 'vale do iajaí','dona emma' : 'vale do iajaí','doutor pedrinho' : 'vale do iajaí','gaspar' : 'vale do iajaí','guabiruba' : 'vale do iajaí','ibirama' : 'vale do iajaí','ilhota' : 'vale do iajaí','imbuia' : 'vale do iajaí','indaial' : 'vale do iajaí','itajai' : 'vale do iajaí','itapema' : 'vale do iajaí','ituporanga' : 'vale do iajaí','jose boiteux' : 'vale do iajaí','laurentino' : 'vale do iajaí','lontras' : 'vale do iajaí','luiz alves' : 'vale do iajaí','mirim doce' : 'vale do iajaí','navegantes' : 'vale do iajaí','penha' : 'vale do iajaí','petrolandia' : 'vale do iajaí','pomerode' : 'vale do iajaí','porto belo' : 'vale do iajaí','pouso redondo' : 'vale do iajaí','presidente getulio' : 'vale do iajaí','presidente nereu' : 'vale do iajaí','rio do campo' : 'vale do iajaí','rio do oeste' : 'vale do iajaí','rio do sul' : 'vale do iajaí','rio dos cedros' : 'vale do iajaí','rodeio' : 'vale do iajaí','salete' : 'vale do iajaí','sao joao do itaperiu' : 'vale do iajaí','taio' : 'vale do iajaí','timbo' : 'vale do iajaí','trombudo central' : 'vale do iajaí','vidal ramos' : 'vale do iajaí','vitor meireles' : 'vale do iajaí','witmarsum' : 'vale do iajaí',</br>'irineopolis':'Norte', 'presidente castello branco':'Oeste'      
							  }</code></pre>
							  <pre><code>df_fatia['Regiao'] = df_fatia['NOME_MUNICIPIO']</br>df_fatia['Regiao'] = df_fatia['Regiao'].str.lower()</br>df_fatia['Regiao'] = df_fatia['Regiao'].map(reg)</br>df_fatia['Regiao'] = df_fatia['Regiao'].map({'norte':'Norte',</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'sul':'Sul',</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'grande florianópolis':'Grande Florianópolis',</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'oeste':'Oeste',</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'serrtana': 'Serrana',</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'vale do iajaí': 'Vale do Iajaí'})</code></pre>
							<pre><code>df_fatia['Regiao'][df_fatia['NOME_MUNICIPIO'] == 'IRINEOPOLIS'] = 'Norte'</br>df_fatia['Regiao'][df_fatia['NOME_MUNICIPIO'] == 'SAO JOAO BATISTA'] = 'Grande Florianópolis'</br>df_fatia['Regiao'][df_fatia['NOME_MUNICIPIO'] == 'PRESIDENTE CASTELLO BRANCO'] = 'Oeste'</br>df_fatia['Regiao'].value_counts())/df_fatia.shape[0]*100).round(2)</code></pre>
							<table border="1" class="dataframe">
								<thead>
								  <tr style="text-align: right;">
									<th>Regiao</th>
									<th>Quantidade de Pessoas (Perc. %)</th>
								  </tr>
								</thead>
								<tbody>
								  <tr>
									<th>Vale do Iajaí</th>
									<td>27.24</td>
								  </tr>
								  <tr>
									<th>Norte</th>
									<td>22.25</td>
								  </tr>
								  <tr>
									<th>Grande Florianópolis</th>
									<td>18.36</td>
								  </tr>
								  <tr>
									<th>Sul</th>
									<td>13.87</td>
								  </tr>
								  <tr>
									<th>Oeste</th>
									<td>13.76</td>
								  </tr>
								  <tr>
									<th>Serrana</th>
									<td>4.52</td>
								  </tr>
								</tbody>
							  </table>
							
							
							
							</details>
										 
										
							  <hr />
							  <br>

							  <details><summary>3.2 PIB por Cidade:</summary>

								<p>Para o enriquecimento da base foi acrescentado a variável PIB por cidade, conforme o <a target="_blank" href="https://pt.wikipedia.org/wiki/Lista_de_munic%C3%ADpios_de_Santa_Catarina_por_PIB">link (Wikipédia)</a>.
									Para coletar tais informações, houve a necessidade de fazer uma 
								limpeza dos dados, devido não estar em formação numérica. </p>
								</p>
								<pre><code>print(pib.head())</code></pre>
								<table border="1" class="dataframe">
									<thead>
									  <tr style="text-align: right;">
										<th></th>
										<th>Município</th>
										<th>PIB em 2018</th>
									  </tr>
									</thead>
									<tbody>
									  <tr>
										<th>0</th>
										<td>Joinville</td>
										<td>30 785 682</td>
									  </tr>
									  <tr>
										<th>1</th>
										<td>Itajaí</td>
										<td>25 413 431</td>
									  </tr>
									  <tr>
										<th>2</th>
										<td>Florianópolis</td>
										<td>21 059 561</td>
									  </tr>
									  <tr>
										<th>3</th>
										<td>Blumenau</td>
										<td>16 958 783</td>
									  </tr>
									  <tr>
										<th>4</th>
										<td>São José</td>
										<td>10 607 482</td>
									  </tr>
									</tbody>
								  </table>

								<pre><code>for i in range(pib.shape[0]):<br>unidecode.unidecode(pib.loc[i,'PIB em 2018'])</code></pre>
								<p>Removendo os ponto e as virgulas.</p>
								<pre><code>pib['pib'] = pib['PIB em 2018'].str.replace(".","")<br>pib['pib'] = pib['pib'].str.replace(",","")</code></pre>
								<p>Removendo os unidecode.</p>
								<pre><code>pib['pib'] = pib['pib'].str.replace(u'\xa0', '')</code></pre>
								<p>Removendo os espaços vazios</p>
								<pre><code>pib['pib'] = pib['pib'].str.replace(" ","")</code></pre>
								<p>Criando a coluna Percentual.</p>
								<pre><code>pib["percentual"] = pib['pib'].astype(int) / pib['pib'].astype(int).sum()</code></pre>
								<p>Removendo a coluna <b>PIB em 2018</b>.</p>
								<pre><code>pib.drop(columns=['PIB em 2018'], inplace = True)</code></pre>
								<p> Criando a coluna <b>Região</b>, com os caracteris todos em minúsculo. </p>
								<pre><code>pib['Regiao'] = pib['Município'].str.lower()</code></pre>

								<p> Manipulando os nomes de todas as cidade do estado de Santa Catarina.</p>

								<pre><code>pib['Regiao']  = pib['Regiao'].map({<br>'joinville' : 'joinville',<br>'itajaí' :  'itajai',<br>'florianópolis' :  'florianopolis',<br>'blumenau' :  'blumenau',<br>'são josé' :  'sao jose',<br>'chapecó' :  'chapeco',<br>'jaraguá do sul' :  'jaragua do sul',<br>'criciúma' :  'criciuma',<br>'brusque' :  'brusque',<br>'balneário camboriú' :  'balneario camboriu',<br>'palhoça' :  'palhoca',<br>...<br>'coronel martins' :  'coronel martins',<br>'matos costa' :  'matos costa',<br>'flor do sertão' :  'flor do sertao',<br>'cunhataí' :  'cunhatai',<br>'barra bonita' :  'barra bonita',<br>'irati' :  'irati',<br>'paial' :  'paial',<br>'são miguel da boa vista' :  'sao miguel da boa vista',<br>'jardinópolis' :  'jardinopolis',<br>'santiago do sul' :  'santiago do sul'})</code></pre>
								<pre><code>pib['Cidade'] = pib['Regiao']</code></pre>
								<pre><code>pib.head()</code></pre>

								<table border="1" class="dataframe">
									<thead>
									  <tr style="text-align: right;">
										<th></th>
										<th>Município</th>
										<th>pib</th>
										<th>percentual</th>
										<th>Cidade</th>
										<th>Regiao</th>
									  </tr>
									</thead>
									<tbody>
									  <tr>
										<th>0</th>
										<td>Joinville</td>
										<td>30785682.0</td>
										<td>0.064574</td>
										<td>joinville</td>
										<td>Norte</td>
									  </tr>
									  <tr>
										<th>1</th>
										<td>Itajaí</td>
										<td>25413431.0</td>
										<td>0.053306</td>
										<td>itajai</td>
										<td>Vale do Iajaí</td>
									  </tr>
									  <tr>
										<th>2</th>
										<td>Florianópolis</td>
										<td>21059561.0</td>
										<td>0.044173</td>
										<td>florianopolis</td>
										<td>Grande Florianópolis</td>
									  </tr>
									  <tr>
										<th>3</th>
										<td>Blumenau</td>
										<td>16958783.0</td>
										<td>0.035572</td>
										<td>blumenau</td>
										<td>Vale do Iajaí</td>
									  </tr>
									  <tr>
										<th>4</th>
										<td>São José</td>
										<td>10607482.0</td>
										<td>0.022250</td>
										<td>sao jose</td>
										<td>Grande Florianópolis</td>
									  </tr>
									</tbody>
								  </table>

								<p> Unindo os conjuntos de dados (merge) PIB e df_fatia.</p>
								<pre><code>pib_merge = pib[['Cidade','pib','percentual']]</code></pre>
								<pre><code>df_fatia['Cidade'] = df_fatia['NOME_MUNICIPIO'].str.lower()</code></pre>
								<pre><code>df_merge_pib = df_fatia.merge(pib_merge,<br>on = 'Cidade',how='left')</code></pre>
								<pre><code>pib.drop(columns =['Regiao'], inplace = True)</code></pre>
								<pre><code>pib = pib.merge(df_fatia[['Cidade','Regiao']].drop_duplicates(),<br>on = 'Cidade',<br>how='left')</code></pre>
								<pre><code>pib['pib'] = pib['pib'].astype(float)</code></pre>
								<pre><code>pib_group = pib.groupby('Regiao')['pib','percentual'].sum()</code></pre>
								<pre><code>pib_group['percentual'] = (pib_group['percentual']*100).round(2)</code></pre>
								<pre><code>pib_group.rename(columns = {'percentual':'Per. (%)'}, inplace = True)</code></pre>
								<pre><code>pib_group</code></pre>

								<table border="1" class="dataframe">
									<thead>
									  <tr style="text-align: right;">
										<th></th>
										<th>pib</th>
										<th>Per. (%)</th>
									  </tr>
									  <tr>
										<th>Regiao</th>
										<th></th>
										<th></th>
									  </tr>
									</thead>
									<tbody>
									  <tr>
										<th>Grande Florianópolis</th>
										<td>44616635.0</td>
										<td>9.36</td>
									  </tr>
									  <tr>
										<th>Norte</th>
										<td>65983990.0</td>
										<td>13.84</td>
									  </tr>
									  <tr>
										<th>Oeste</th>
										<td>46454513.0</td>
										<td>9.74</td>
									  </tr>
									  <tr>
										<th>Serrana</th>
										<td>12623611.0</td>
										<td>2.65</td>
									  </tr>
									  <tr>
										<th>Sul</th>
										<td>31170034.0</td>
										<td>6.54</td>
									  </tr>
									  <tr>
										<th>Vale do Iajaí</th>
										<td>272782471.0</td>
										<td>57.22</td>
									  </tr>
									</tbody>
								  </table>


								<p> Salvando os conjuntos de dados.</p>
								<pre><code>pib.to_csv('pib_cidade_limpo.csv', index = False)</code></pre>
								<pre><code>pib_group.to_csv('pib_por_regiao.csv', index = False)</code></pre>
								<pre><code>df_merge_pib.to_csv('df_merge_pib.csv', index = False)</code></pre>

							</details>
										 
										
							<hr />
							<br>

							<details><summary>3.3 PIB Médio por Cidade:</summary>

								<p>Criando um PIB médio por cidade</p>

								<pre><code>pib_group.reset_index(inplace = True)</code></pre>
								<p>Criar uma lista com a quantidade de cidade por região:</p>
								<pre><code>lista = [len(pib[pib['Regiao'] == 'Grande Florianópolis']['Cidade'].unique()),</br>&nbsp;&nbsp;&nbsp;len(pib[pib['Regiao'] == 'Norte']['Cidade'].unique()),</br>&nbsp;&nbsp;&nbsp;len(pib[pib['Regiao'] == 'Oeste']['Cidade'].unique()),</br>&nbsp;&nbsp;&nbsp;len(pib[pib['Regiao'] == 'Serrana']['Cidade'].unique()),</br>&nbsp;&nbsp;&nbsp;len(pib[pib['Regiao'] == 'Sul']['Cidade'].unique()),</br>&nbsp;&nbsp;&nbsp;len(pib[pib['Regiao'] == 'Vale do Iajaí']['Cidade'].unique())]</code></pre>
								<pre><code>cidade = pd.DataFrame({'Regiao': pib_group.Regiao,</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"n_cidade":lista})</code></pre>
								<pre><code>cidade</code></pre>

								<table border="1" class="dataframe">
									<thead>
									  <tr style="text-align: right;">
										<th></th>
										<th>Regiao</th>
										<th>n_cidade</th>
									  </tr>
									</thead>
									<tbody>
									  <tr>
										<th>0</th>
										<td>Grande Florianópolis</td>
										<td>20</td>
									  </tr>
									  <tr>
										<th>1</th>
										<td>Norte</td>
										<td>26</td>
									  </tr>
									  <tr>
										<th>2</th>
										<td>Oeste</td>
										<td>116</td>
									  </tr>
									  <tr>
										<th>3</th>
										<td>Serrana</td>
										<td>29</td>
									  </tr>
									  <tr>
										<th>4</th>
										<td>Sul</td>
										<td>44</td>
									  </tr>
									  <tr>
										<th>5</th>
										<td>Vale do Iajaí</td>
										<td>53</td>
									  </tr>
									</tbody>
								  </table>

								  <pre><code>pib_regiao = pib_group.merge(cidade)</br>pib_regiao</code></pre>

								  <table border="1" class="dataframe">
									<thead>
									  <tr style="text-align: right;">
										<th></th>
										<th>Regiao</th>
										<th>pib</th>
										<th>Per. (%)</th>
										<th>n_cidade</th>
										<th>Pib_medio_cidade</th>
									  </tr>
									</thead>
									<tbody>
									  <tr>
										<th>0</th>
										<td>Grande Florianópolis</td>
										<td>44616635.0</td>
										<td>9.42</td>
										<td>20</td>
										<td>2230831.75</td>
									  </tr>
									  <tr>
										<th>1</th>
										<td>Norte</td>
										<td>65983990.0</td>
										<td>13.93</td>
										<td>26</td>
										<td>2537845.77</td>
									  </tr>
									  <tr>
										<th>2</th>
										<td>Oeste</td>
										<td>46454513.0</td>
										<td>9.80</td>
										<td>116</td>
										<td>400469.94</td>
									  </tr>
									  <tr>
										<th>3</th>
										<td>Serrana</td>
										<td>12623611.0</td>
										<td>2.67</td>
										<td>29</td>
										<td>435296.93</td>
									  </tr>
									  <tr>
										<th>4</th>
										<td>Sul</td>
										<td>31170034.0</td>
										<td>6.58</td>
										<td>44</td>
										<td>708409.86</td>
									  </tr>
									  <tr>
										<th>5</th>
										<td>Vale do Iajaí</td>
										<td>272782471.0</td>
										<td>57.59</td>
										<td>53</td>
										<td>5146839.08</td>
									  </tr>
									</tbody>
								  </table>

								  <pre><code>pib_regiao['Pib_medio_cidade'] = (pib_regiao['pib'] / pib_regiao['n_cidade']).round(2)
								</br>pib_regiao['Per. (%)'] = (pib_regiao['Per. (%)']/pib_regiao['Per. (%)'].sum()*100).round(2)</code></pre>
								  <pre><code>pib_regiao.sort_values(by = ['Per. (%)'], ascending = False)</code></pre>

								  <table border="1" class="dataframe">
									<thead>
									  <tr style="text-align: right;">
										<th></th>
										<th>Regiao</th>
										<th>pib</th>
										<th>Per. (%)</th>
										<th>n_cidade</th>
										<th>Pib_medio_cidade</th>
									  </tr>
									</thead>
									<tbody>
									  <tr>
										<th>5</th>
										<td>Vale do Iajaí</td>
										<td>272782471</td>
										<td>57.59</td>
										<td>53</td>
										<td>5146839.08</td>
									  </tr>
									  <tr>
										<th>1</th>
										<td>Norte</td>
										<td>65983990</td>
										<td>13.93</td>
										<td>26</td>
										<td>2537845.77</td>
									  </tr>
									  <tr>
										<th>2</th>
										<td>Oeste</td>
										<td>46454513</td>
										<td>9.80</td>
										<td>116</td>
										<td>400469.94</td>
									  </tr>
									  <tr>
										<th>0</th>
										<td>Grande Florianópolis</td>
										<td>44616635</td>
										<td>9.42</td>
										<td>20</td>
										<td>2230831.75</td>
									  </tr>
									  <tr>
										<th>4</th>
										<td>Sul</td>
										<td>31170034</td>
										<td>6.58</td>
										<td>44</td>
										<td>708409.86</td>
									  </tr>
									  <tr>
										<th>3</th>
										<td>Serrana</td>
										<td>12623611</td>
										<td>2.67</td>
										<td>29</td>
										<td>435296.93</td>
									  </tr>
									</tbody>
								  </table>

								</details>

								  <hr />
								  <br>
	  



							<h2>4. Coluna Prestação</h2>

							<details><summary>4.1 Estágio e Horário de Trabalho:</summary>
								<p> A coluna <b> Pretenção</b> possuem diversas informações,
								que teremos que organizar para conseguir obter os dados de forma separada. </p>
								<pre><code>prest = df_merge_pib.copy() </code></pre>
								<pre><code>prest.loc[0,'PRETENSOES']</code></pre>
								<p># '724405-CALDEIREIRO (CHAPAS DE COBRE)(N,6,0,Indiferente)|724435-Funileiro industrial(N,99,0,Indiferente)|</br>731105-MONTADOR DE EQUIPAMENTOS ELETRONICOS (APARELHOS MEDICOS)(N,3,0,Comercial)</br>784205-Auxiliar de linha de produção(N,0,0,Indiferente)'</p>
								<p> Essa coluna possue pretenção de emprego, estágio, trabalho informal, trabalho formal e horário pretendido para trabalhar. 
									É possível obter todos este dados 
									de forma separada.</p>
								
								<pre><code>padrao = re.compile('[N-S]?(,)[0-9]?[0-9]?[0-9]?[0-9]?(,)[0-9]?[0-9]?[0-9]?[0-9]?,(Indiferente)?(Comercial)?(Manhã)?(Tarde)?(Noite)?(Madrugada)?(Manhã/Tarde)?(Manhã/Noite)?(Manhã/Madrugada)?(Manhã/Tarde/Noite)?(Manhã/Tarde/Madrugada)?(Manhã/Noite/Madrugada)?(Manhã/Tarde/Noite/Madrugada)?(Tarde/Noite)?(Tarde/Madrugada)?(Tarde/Noite/Madrugada)?(Noite/Madrugada)?')</br>prest['info'] = None</code></pre>
								<pre><code>prest.dropna(subset =['PRETENSOES'], inplace = True)</code></pre>
								<pre><code>prest.reset_index(inplace = True)</br>prest.drop(columns = ['index'], inplace = True)</code></pre>
								<pre><code>inf = []</br>for i in range(prest.shape[0]):</br>&nbsp;&nbsp;&nbsp;acrescenta = padrao.search(prest.loc[i,'PRETENSOES']).group()</br>&nbsp;&nbsp;&nbsp;inf.append(acrescenta)</code></pre>
								<p> Segue amostra dos dados higienizados:</p>
								<p>['N,6,0,Indiferente',</br>'N,166,0,Indiferente',</br>'N,0,0,Indiferente',</br>'N,55,0,Indiferente',</br>'N,3,0,Indiferente']</p>
								<pre><code>prest['info'] = inf</code></pre>
								<pre><code>estagio, Experiencia_Formal, Experiencia_informal, Horario = [], [], [], []</br>for i in range(prest.shape[0]):</br>&nbsp;&nbsp;&nbsp;inf = prest.loc[i,'info'].split(sep = ',')</br>&nbsp;&nbsp;&nbsp;estagio.append(inf[0])</br>&nbsp;&nbsp;&nbsp;Experiencia_Formal.append(inf[1])</br>&nbsp;&nbsp;&nbsp;Experiencia_informal.append(inf[2])</br>&nbsp;&nbsp;&nbsp;Horario.append(inf[3])</code></pre>

								<pre><code>prest['Estagio'] = estagio</br>prest['Experiencia_Formal'] = Experiencia_Formal</br>prest['Experiencia_informal'] = Experiencia_informal</br>prest['Horario'] = Horario</code></pre>

								<pre><code>prest[['Nivel_esc','Regiao','Cidade','pib','percentual','info','Estagio','Experiencia_Formal','Experiencia_informal','Horario']].head()
								</code></pre>

								<table border="1" class="dataframe">
									<thead>
									  <tr style="text-align: right;">
										<th></th>
										<th>Nivel_esc</th>
										<th>Regiao</th>
										<th>Cidade</th>
										<th>pib</th>
										<th>percentual</th>
										<th>info</th>
										<th>Estagio</th>
										<th>Experiencia_Formal</th>
										<th>Experiencia_informal</th>
										<th>Horario</th>
									  </tr>
									</thead>
									<tbody>
									  <tr>
										<th>0</th>
										<td>2</td>
										<td>Norte</td>
										<td>joinville</td>
										<td>30785682</td>
										<td>0.064574</td>
										<td>N,6,0,Indiferente</td>
										<td>N</td>
										<td>6</td>
										<td>0</td>
										<td>Indiferente</td>
									  </tr>
									  <tr>
										<th>1</th>
										<td>1</td>
										<td>Norte</td>
										<td>papanduva</td>
										<td>543649</td>
										<td>0.001140</td>
										<td>N,166,0,Indiferente</td>
										<td>N</td>
										<td>166</td>
										<td>0</td>
										<td>Indiferente</td>
									  </tr>
									  <tr>
										<th>2</th>
										<td>3</td>
										<td>Grande Florianópolis</td>
										<td>palhoca</td>
										<td>5489675</td>
										<td>0.011515</td>
										<td>N,0,0,Indiferente</td>
										<td>N</td>
										<td>0</td>
										<td>0</td>
										<td>Indiferente</td>
									  </tr>
									  <tr>
										<th>3</th>
										<td>2</td>
										<td>Sul</td>
										<td>capivari de baixo</td>
										<td>429616</td>
										<td>0.000901</td>
										<td>N,55,0,Indiferente</td>
										<td>N</td>
										<td>55</td>
										<td>0</td>
										<td>Indiferente</td>
									  </tr>
									  <tr>
										<th>4</th>
										<td>2</td>
										<td>Vale do Iajaí</td>
										<td>navegantes</td>
										<td>3820583</td>
										<td>0.008014</td>
										<td>N,3,0,Indiferente</td>
										<td>N</td>
										<td>3</td>
										<td>0</td>
										<td>Indiferente</td>
									  </tr>
									</tbody>
								  </table>
								  
								</details>

								<hr />
								<br>
	
						  <details><summary>4.2 Cargo Pretendido:</summary>
							<p>Coletamos separadamento as pretenções solicitadas por trabalhados. Com o CBO identificado, consegui enriquecer os dados com novas informações.
								atrás do conjunto de dados do site:
								<a target="_blank"  href="https://www.salario.com.br/tabela-salarial/">salario.com.br</a>.</p>
								<pre><code>df_CBO.head()</code></pre>

								<table border="1" class="dataframe">
									<thead>
									  <tr style="text-align: right;">
										<th></th>
										<th>CBO</th>
										<th>Cargo</th>
										<th>Carga Horária</th>
										<th>Piso Salarial</th>
										<th>Média Salarial</th>
										<th>Salário Mediana</th>
										<th>Teto Salarial</th>
										<th>Salário Hora</th>
									  </tr>
									</thead>
									<tbody>
									  <tr>
										<th>0</th>
										<td>612510</td>
										<td>Abacaxicultor</td>
										<td>41</td>
										<td>1.313,38</td>
										<td>1.439,02</td>
										<td>1.134,65</td>
										<td>2.174,69</td>
										<td>7,09</td>
									  </tr>
									  <tr>
										<th>1</th>
										<td>263105</td>
										<td>Abade</td>
										<td>40</td>
										<td>2.983,98</td>
										<td>3.269,43</td>
										<td>2.197,00</td>
										<td>4.940,87</td>
										<td>16,54</td>
									  </tr>
									  <tr>
										<th>2</th>
										<td>263105</td>
										<td>Abadessa</td>
										<td>40</td>
										<td>2.983,98</td>
										<td>3.269,43</td>
										<td>2.197,00</td>
										<td>4.940,87</td>
										<td>16,54</td>
									  </tr>
									  <tr>
										<th>3</th>
										<td>622020</td>
										<td>Abanador na Agricultura</td>
										<td>44</td>
										<td>1.220,07</td>
										<td>1.336,78</td>
										<td>1.232,44</td>
										<td>2.020,18</td>
										<td>6,1</td>
									  </tr>
									  <tr>
										<th>4</th>
										<td>862120</td>
										<td>Abastecedor de Caldeira</td>
										<td>43</td>
										<td>1.619,68</td>
										<td>1.774,62</td>
										<td>1.636,76</td>
										<td>2.681,86</td>
										<td>8,24</td>
									  </tr>
									</tbody>
								  </table>

								  <pre><code># Ordenando o arquivo CBO</br>df_CBO.sort_values("CBO", inplace = True) </br>print(df_CBO.shape)</br></br># Elimando os registros duplicados em CBO, deixando apenas o primeiro de cada chave</br>df_CBO.drop_duplicates(subset ="CBO",keep = 'first', inplace = True)</br>df_CBO = df_CBO.reset_index(drop=True)</br>print(df_CBO.shape)</code></pre>
								  <p># (9334, 8)</p>
								  <p># (2334, 8)</p>

								  <pre><code># Transformando as strings de Média Salarial e Salário Mediana em numérico (float)</br></br>def transforma_float(x):</br>&nbsp;&nbsp;&nbsp;return float(x.replace('.','').replace(',','.'))</br></br>df_CBO['CBO'] = df_CBO['CBO'].map(str)</br>cbo_colunas = df_CBO.columns </br>for i in range(3,8):</br>&nbsp;&nbsp;&nbsp;df_CBO[cbo_colunas[i]] = df_CBO[cbo_colunas[i]].apply(lambda x: transforma_float(x))</br></br>df_CBO['CBO'].head()</code></pre>
									<p>0&nbsp;&nbsp;&nbsp;111120</br>1&nbsp;&nbsp;&nbsp;111220</br>2&nbsp;&nbsp;&nbsp;111320</br>3&nbsp;&nbsp;&nbsp;111405</br>4&nbsp;&nbsp;&nbsp;111410</br>Name: CBO, dtype: object</p>
									<pre><code>padrao = re.compile('[0-9]{6}')</br></br>lista = []</br>def get_cbo(row):</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if type(row) == float and np.isnan(row):</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return []</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return re.findall(padrao, row)</br></br>lista.append(prest['PRETENSOES'].apply(get_cbo))</code></pre>
									<pre><code>count = []</br></br>for i in range(len(lista[0])):</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count.append(len(lista[0][i]))</code></pre>
									<pre><code>cbo_cid , cidadao = [], []</br></br>for num in range(len(lista[0])):</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for i in range(count[num]):</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cbo_cid.append(lista[0][num][i])</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cidadao.append(num)</code></pre>
									<pre><code>df_cbo_cidadao = pd.DataFrame({'cbo': cbo_cid, 'id_cidadao' : cidadao})</code></pre>
									<pre><code>df_cbo_cidadao = df_cbo_cidadao.merge(df_CBO,</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left_on = 'cbo',</br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;right_on = 'CBO')</code></pre>
									<pre><code>df_cbo_cidadao.drop(columns =['CBO'], inplace = True)</code></pre>
									<p>Vamos observar o a terceira observação, ou cidadao. Ele teve 04 pretenção de emprego.</p>
									<pre><code>df_cbo_cidadao[df_cbo_cidadao['id_cidadao'] == 3]</code></pre>
									<table border="1" class="dataframe">
										<thead>
										  <tr style="text-align: right;">
											<th></th>
											<th>cbo</th>
											<th>id_cidadao</th>
											<th>Cargo</th>
											<th>Carga Horária</th>
											<th>Piso Salarial</th>
											<th>Média Salarial</th>
											<th>Salário Mediana</th>
											<th>Teto Salarial</th>
											<th>Salário Hora</th>
										  </tr>
										</thead>
										<tbody>
										  <tr>
											<th>176803</th>
											<td>521110</td>
											<td>3</td>
											<td>Consultor de Vendas</td>
											<td>43</td>
											<td>1240.57</td>
											<td>1359.25</td>
											<td>1294.34</td>
											<td>2054.14</td>
											<td>6.27</td>
										  </tr>
										  <tr>
											<th>176804</th>
											<td>521110</td>
											<td>3</td>
											<td>Operador de Vendas (lojas)</td>
											<td>43</td>
											<td>1240.57</td>
											<td>1359.25</td>
											<td>1294.34</td>
											<td>2054.14</td>
											<td>6.27</td>
										  </tr>
										  <tr>
											<th>176805</th>
											<td>521110</td>
											<td>3</td>
											<td>Vendedor - no Comércio de Mercadorias</td>
											<td>43</td>
											<td>1240.57</td>
											<td>1359.25</td>
											<td>1294.34</td>
											<td>2054.14</td>
											<td>6.27</td>
										  </tr>
										  <tr>
											<th>176806</th>
											<td>521110</td>
											<td>3</td>
											<td>Vendedor de Comercio Varejista</td>
											<td>43</td>
											<td>1240.57</td>
											<td>1359.25</td>
											<td>1294.34</td>
											<td>2054.14</td>
											<td>6.27</td>
										  </tr>
										  <tr>
											<th>176807</th>
											<td>521110</td>
											<td>3</td>
											<td>Vendedor Interno</td>
											<td>43</td>
											<td>1240.57</td>
											<td>1359.25</td>
											<td>1294.34</td>
											<td>2054.14</td>
											<td>6.27</td>
										  </tr>
										</tbody>
									  </table>
									<pre><code>df_cbo_cidadao.head()</code></pre>

									<table border="1" class="dataframe">
										<thead>
										  <tr style="text-align: right;">
											<th></th>
											<th>cbo</th>
											<th>id_cidadao</th>
											<th>Cargo</th>
											<th>Carga Horária</th>
											<th>Piso Salarial</th>
											<th>Média Salarial</th>
											<th>Salário Mediana</th>
											<th>Teto Salarial</th>
											<th>Salário Hora</th>
										  </tr>
										</thead>
										<tbody>
										  <tr>
											<th>0</th>
											<td>724405</td>
											<td>0</td>
											<td>Caldeireiro (Chapas de Cobre)</td>
											<td>44</td>
											<td>2224.17</td>
											<td>2436.94</td>
											<td>2285.8</td>
											<td>3682.77</td>
											<td>11.11</td>
										  </tr>
										  <tr>
											<th>1</th>
											<td>724405</td>
											<td>657</td>
											<td>Caldeireiro (Chapas de Cobre)</td>
											<td>44</td>
											<td>2224.17</td>
											<td>2436.94</td>
											<td>2285.8</td>
											<td>3682.77</td>
											<td>11.11</td>
										  </tr>
										  <tr>
											<th>2</th>
											<td>724405</td>
											<td>1419</td>
											<td>Caldeireiro (Chapas de Cobre)</td>
											<td>44</td>
											<td>2224.17</td>
											<td>2436.94</td>
											<td>2285.8</td>
											<td>3682.77</td>
											<td>11.11</td>
										  </tr>
										  <tr>
											<th>3</th>
											<td>724405</td>
											<td>1943</td>
											<td>Caldeireiro (Chapas de Cobre)</td>
											<td>44</td>
											<td>2224.17</td>
											<td>2436.94</td>
											<td>2285.8</td>
											<td>3682.77</td>
											<td>11.11</td>
										  </tr>
										  <tr>
											<th>4</th>
											<td>724405</td>
											<td>2579</td>
											<td>Caldeireiro (Chapas de Cobre)</td>
											<td>44</td>
											<td>2224.17</td>
											<td>2436.94</td>
											<td>2285.8</td>
											<td>3682.77</td>
											<td>11.11</td>
										  </tr>
										</tbody>
									  </table>


									<pre><code>df_cbo_cidadao.groupby('id_cidadao')[['Piso Salarial','Teto Salarial']].agg(['min','median','mean','max','std']).head()</code></pre>

									<table border="1" class="dataframe">
										<thead>
										  <tr>
											<th></th>
											<th colspan="5" halign="left">Piso Salarial</th>
											<th colspan="5" halign="left">Teto Salarial</th>
										  </tr>
										  <tr>
											<th></th>
											<th>min</th>
											<th>median</th>
											<th>mean</th>
											<th>max</th>
											<th>std</th>
											<th>min</th>
											<th>median</th>
											<th>mean</th>
											<th>max</th>
											<th>std</th>
										  </tr>
										  <tr>
											<th>id_cidadao</th>
											<th></th>
											<th></th>
											<th></th>
											<th></th>
											<th></th>
											<th></th>
											<th></th>
											<th></th>
											<th></th>
											<th></th>
										  </tr>
										</thead>
										<tbody>
										  <tr>
											<th>0</th>
											<td>1280.47</td>
											<td>1688.845</td>
											<td>1599.946875</td>
											<td>2224.17</td>
											<td>317.058355</td>
											<td>2120.20</td>
											<td>2796.385</td>
											<td>2649.187500</td>
											<td>3682.77</td>
											<td>524.982724</td>
										  </tr>
										  <tr>
											<th>1</th>
											<td>1240.57</td>
											<td>1240.570</td>
											<td>2303.770000</td>
											<td>3632.77</td>
											<td>1260.800103</td>
											<td>2054.14</td>
											<td>2054.140</td>
											<td>3814.584444</td>
											<td>6015.14</td>
											<td>2087.630302</td>
										  </tr>
										  <tr>
											<th>2</th>
											<td>1192.69</td>
											<td>1240.570</td>
											<td>1399.186000</td>
											<td>2450.67</td>
											<td>401.193490</td>
											<td>1974.85</td>
											<td>2054.140</td>
											<td>2316.770000</td>
											<td>4057.81</td>
											<td>664.297188</td>
										  </tr>
										  <tr>
											<th>3</th>
											<td>1240.57</td>
											<td>1240.570</td>
											<td>1240.570000</td>
											<td>1240.57</td>
											<td>0.000000</td>
											<td>2054.14</td>
											<td>2054.140</td>
											<td>2054.140000</td>
											<td>2054.14</td>
											<td>0.000000</td>
										  </tr>
										  <tr>
											<th>5</th>
											<td>1132.92</td>
											<td>1227.410</td>
											<td>1222.081364</td>
											<td>1292.58</td>
											<td>54.245144</td>
											<td>1875.89</td>
											<td>2032.345</td>
											<td>2023.522273</td>
											<td>2140.26</td>
											<td>89.817688</td>
										  </tr>
										</tbody>
									  </table>
									  
								  
								</details>

								<hr />
								<br>
									<!-- Three -->
							<section id="three">
								<div class="inner">
									<header class="major">
										<h2>Análise Exploratória</h2>
									</header>
									<p style="text-align: justify;">Visualização detalhada do conjunto de dados, transformando - os,
										em informações ricas, para obtenção de insights de negócios.</p>

								<ul class="actions">
									<li><a href="exploratory_analysis.html" class="button next">Análise Exploratória</a></li>
								</ul>

	

								  









								
								
								
								
								
								
								</header>

									

								</div>

							</section>

					</div>

				

			<!-- Footer -->
			<footer id="footer">
				<div class="inner">
					
					<a target="_blank" href="https://github.com/dsadatatree/dsadatatree" class="icon brands alt fa-github"><span class="label">GitHub</span></a></li>
						<img ALIGN=RIGHT src="images/startup.png"  width= 12% alt="" />
					</ul>
					<ul class="copyright">	</br>							
						&copy; 2021 Untitled. All rights reserved | Design: Data Tree</li></ul>
				</div>
			</footer>

	</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>